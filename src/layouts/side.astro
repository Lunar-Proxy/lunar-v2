---
import '@/main.css';
import Item from '../components/navitem.astro';
---

<aside
  class="border-border-default bg-background-overlay fixed top-0 bottom-0 left-0 z-50 flex h-full w-[72px] flex-col items-center overflow-visible rounded-md border-r-[1.8px] pt-5 shadow-lg">
  <Item name="Home" icon="moon-star" />
  <i data-lucide="minus" class="mb-3 h-5 w-5 text-gray-500 opacity-60"></i>
  <Item name="Search" icon="search" />
  <Item name="Games" icon="gamepad" />
  <Item name="Apps" icon="grip" />
  <i data-lucide="minus" class="mb-3 h-5 w-5 text-gray-500 opacity-60"></i>
  <Item name="VM" icon="monitor" />
  <Item name="Tools" icon="hammer" />
  <Item name="Settings" icon="settings" />
  <i data-lucide="minus" class="mb-3 h-5 w-5 text-gray-500 opacity-60"></i>
  <Item id="parentSignIn" name="AB Cloak (Ctrl Z)" icon="eye-off" />
  <Item id="LoginForm" name="Exit (Ctrl + X)" icon="log-out" />
</aside>

<script>
  document.addEventListener('DOMContentLoaded', function () {
    document.getElementById('LoginForm')?.addEventListener('click', function () {
      console.log('exit clicked');
      const event = new KeyboardEvent('keydown', {
        key: 'x',
        ctrlKey: true,
        bubbles: true,
      });
      document.dispatchEvent(event);
    });

    document.getElementById('parentSignIn')?.addEventListener('click', function () {
      console.log('cloak clicked');
      const event = new KeyboardEvent('keydown', {
        key: 'z',
        ctrlKey: true,
        bubbles: true,
      });
      document.dispatchEvent(event);
    });
  });

  const frameNavigator = document.querySelector('iframe') as HTMLIFrameElement | null;
  const Navigation = [
    { btn: 'Home', url: '/welcome' },
    { btn: 'Search', url: '/tab' },
    { btn: 'Games', url: '/math' },
    { btn: 'Apps', url: '/sci' },
    { btn: 'VM', url: '/v' },
    { btn: 'Tools', url: '/to' },
    { btn: 'Settings', url: '/st' },
  ];

  Navigation.forEach(({ btn, url }) => {
    const button =
      Array.from(document.querySelectorAll('span'))
        .find(el => el.textContent?.trim() === btn)
        ?.previousElementSibling?.querySelector('button') || null;

    if (button) {
      button!.addEventListener('click', () => {
        // @ts-ignore f you
        frameNavigator.src = url;
      });
    }
  });
</script>
