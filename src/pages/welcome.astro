---
import '@/main.css';
import messages from '@assets/json/messages.json';
import ImportLucide from '../layouts/lucide.astro';

function getQuote() {
  const index = Math.floor(Math.random() * messages.length);
  return messages[index].message;
}
const Quote = getQuote();
---

<html lang="en">
  <head>
    <style>
      @keyframes glow {
        0% {
          text-shadow:
            0 0 5px #3b82f6,
            0 0 10px #3b82f6,
            0 0 15px #3b82f6,
            0 0 20px #3b82f6;
        }
        50% {
          text-shadow:
            0 0 10px #3b82f6,
            0 0 15px #3b82f6,
            0 0 20px #3b82f6,
            0 0 25px #3b82f6;
        }
        100% {
          text-shadow:
            0 0 5px #3b82f6,
            0 0 10px #3b82f6,
            0 0 15px #3b82f6,
            0 0 20px #3b82f6;
        }
      }

      @keyframes fadeUp {
        from {
          opacity: 0;
          transform: translateY(20px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      .logo {
        animation:
          glow 1.5s ease-in-out infinite alternate,
          fadeUp 1s ease-out;
      }

      .fade-in-up {
        animation: fadeUp 0.8s ease-out both;
      }

      .icons {
        animation: fadeUp 0.8s ease-out both;
      }
    </style>
    <script src="../utils/home.ts"></script>
  </head>
  <body
    class="bg-background text-text-header flex min-h-screen flex-col items-center justify-center gap-12 px-6 py-16 sm:px-12">
    <h1 class="logo font-linux text-text-header text-center text-6xl font-bold sm:text-7xl md:text-8xl lg:text-9xl">
      Lunar
    </h1>
    <p class="fade-in-up text-text-secondary max-w-4xl px-4 text-center font-mono text-lg sm:text-xl md:text-2xl">
      {Quote}
    </p>
   <div class="fade-in-up w-full max-w-6xl px-4">
      <div class="relative">
        <img 
          src="/api/icon/?url=https://duckduckgo.com" 
          class="icons absolute left-5 top-1/2 transform -translate-y-1/2 w-8 h-8 z-10 rounded-full object-cover" 
        />
        <input
          type="text"
          placeholder="Type something..."
          class="w-full pl-20 pr-16 py-5 text-lg sm:text-xl rounded-full border-2 border-border-default bg-background-overlay font-linux text-text-secondary placeholder-gray-400 shadow-lg backdrop-blur-md transition duration-300 ease-in-out hover:scale-[1.01] focus:outline-none"
        />
        <i data-lucide="search" class="absolute right-5 top-1/2 transform -translate-y-1/2 w-6 h-6 z-10 text-gray-400"></i>
      </div>
    </div>

    <script>
      import ConfigAPI from '../utils/config';

      async function updateIcon() {
        const engine = await ConfigAPI.get('engine');
        const icon = document.getElementById('search-engine-icon') as HTMLImageElement | null;

        if (icon && typeof engine === 'string' && engine.length > 0) {
          let domain = engine;
          try {
            const url = new URL(engine);
            domain = url.hostname;
          } catch {
            domain = engine.replace(/^https?:\/\//, '').split('/')[0];
          }

          icon.src = `/api/icon/?url=https://${domain}`;
        }
      }

      updateIcon();
    </script>

    <section
      id="updates"
      class="fade-in-up bg-background-overlay mt-6 flex w-full max-w-2xl items-start gap-4 rounded-2xl border border-blue-900 p-6 shadow-xl backdrop-blur-md transition duration-300 ease-in-out hover:scale-[1.02] hover:shadow-blue-700/50"
      role="region">
      <i data-lucide="info" class="h-8 w-8 flex-shrink-0 text-blue-500"></i>
      <div class="w-full">
        <div class="flex items-center justify-between mb-4">
          <h3 class="font-linux text-2xl font-semibold tracking-wide text-white">v2.0 ChangeLog</h3>
        </div>
        <div class="space-y-4">
          <div class="border-l-2 border-green-500 pl-4">
            <h4 class="text-green-400 font-mono text-sm font-semibold mb-2">Lunar v2 release</h4>
          </div>
      </div>
    </section>
  </body>
  <ImportLucide />
</html>
