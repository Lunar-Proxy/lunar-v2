---
import ImportLucide from '../layouts/lucide.astro';

interface Game {
  name: string;
  desc: string;
  url: string;
  icon: string;
}

const { list = [] }: { list?: Game[] } = Astro.props;
---

<html lang="en">
  <head>
    <style>
      ::-webkit-scrollbar {
        width: 10px;
      }

      ::-webkit-scrollbar-track {
        background: #1f1d2e;
        border-radius: 10px;
      }

      ::-webkit-scrollbar-thumb {
        background: #c4a7e7;
        border-radius: 10px;
        border: 2px solid #1f1d2e;
      }

      ::-webkit-scrollbar-thumb:hover {
        background: #d0a0f0;
      }

      * {
        scrollbar-width: thin;
        scrollbar-color: #c4a7e7 #1f1d2e;
      }

      @keyframes fadeInUp {
        from {
          opacity: 0;
          transform: translateY(20px);
          filter: blur(10px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
          filter: blur(0);
        }
      }

      @keyframes shine {
        0% {
          transform: translateX(-100%) rotate(25deg);
        }
        100% {
          transform: translateX(100%) rotate(25deg);
        }
      }

      .shine::before {
        content: '';
        position: absolute;
        top: -100%;
        left: -100%;
        width: 200%;
        height: 200%;
        background: linear-gradient(120deg, transparent, rgba(255, 255, 255, 0.08), transparent);
        animation: shine 2.5s infinite;
        pointer-events: none;
        z-index: 1;
      }

      .card-glow {
        transition: all 0.4s ease;
      }

      .card-glow:hover {
        box-shadow:
          0 0 20px rgba(216, 191, 216, 0.1),
          0 0 40px rgba(216, 191, 216, 0.07),
          0 0 60px rgba(216, 191, 216, 0.04);
        transform: scale(1.05);
      }

      .card-loading {
        background: linear-gradient(135deg, #1f1d2e, #191724);
        animation: pulse 1.5s infinite ease-in-out;
        filter: blur(8px);
      }

      @keyframes pulse {
        0%,
        100% {
          opacity: 0.8;
        }
        50% {
          opacity: 1;
        }
      }
    </style>

    <script>
      document.addEventListener('DOMContentLoaded', () => {
        const cards = document.querySelectorAll('.card');
        cards.forEach(card => {
          if (!(card instanceof HTMLElement)) return;

          const img = new Image();
          const bg = card.dataset.bg;
          if (!bg) return;

          img.src = bg;
          img.onload = () => {
            card.classList.remove('card-loading', 'shine');
            card.style.backgroundImage = `url('${img.src}')`;
          };
        });

        const gridView = document.querySelector('[data-view="grid"]');
        const listView = document.querySelector('[data-view="list"]');
        const container = document.querySelector('[data-container]');

        gridView?.addEventListener('click', () => {
          container?.classList.remove('flex', 'flex-col', 'space-y-6');
          container?.classList.add(
            'grid',
            'grid-cols-1',
            'sm:grid-cols-2',
            'md:grid-cols-3',
            'lg:grid-cols-4',
            'gap-8'
          );
        });

        listView?.addEventListener('click', () => {
          container?.classList.remove(
            'grid',
            'grid-cols-1',
            'sm:grid-cols-2',
            'md:grid-cols-3',
            'lg:grid-cols-4',
            'gap-8'
          );
          container?.classList.add('flex', 'flex-col', 'space-y-6');
        });
      });
    </script>
  </head>

  <body class="font-linux min-h-screen overflow-x-hidden p-6 font-sans text-[#e0def4]">
    <div class="mx-auto mb-8 flex max-w-7xl items-center justify-between">
      <div class="flex items-center gap-3">
        <input
          type="text"
          data-input="why-are-you-looking-here->:("
          placeholder="Search through 9 apps"
          class="font-linux border-border-default bg-background-overlay text-text-header h-9 h-[48px] w-[260px] rounded-[9999px] border px-4 text-sm placeholder-[#a3aed0] focus:ring-2 focus:ring-[#c4a7e7] focus:outline-none"
        />
        <button
          class="bg-background-overlay border-border-default flex h-12 w-14 items-center justify-center rounded-lg border shadow-md transition-all duration-200 hover:bg-[#26233a]">
          <i data-lucide="dice-6" data-random="stawwwp" class="h-6 w-6 text-[#9aa0b3]"></i>
        </button>
      </div>

      <div class="ml-4 flex gap-3">
        <button
          data-view="grid"
          class="bg-background-overlay border-border-default flex h-12 w-14 items-center justify-center rounded-xl border shadow-md transition-all duration-200 hover:bg-[#26233a]">
          <i data-lucide="grid-2x2" class="h-6 w-6 text-[#9aa0b3]"></i>
        </button>
        <button
          data-view="list"
          class="bg-background-overlay border-border-default flex h-12 w-14 items-center justify-center rounded-xl border shadow-md transition-all duration-200 hover:bg-[#26233a]">
          <i data-lucide="list" class="h-6 w-6 text-[#9aa0b3]"></i>
        </button>
      </div>
    </div>

    <div data-container class="mx-auto grid max-w-7xl grid-cols-1 gap-8 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4">
      {
        list.map((game, i) => (
          <a
            data-href={game.url}
            target="_blank"
            data-bg={game.icon}
            class="card card-glow card-loading shine relative flex h-[148px] flex-col justify-between overflow-hidden rounded-2xl border border-[#26233a] bg-cover bg-center bg-no-repeat transition-transform duration-300 hover:scale-105"
            style={`animation: fadeInUp 0.6s ease-out ${i * 0.1}s both;`}>
            <div class="bg-background-overlay/60 absolute inset-0 z-10 backdrop-blur-sm transition-all duration-300 hover:bg-black/40" />
            <div class="relative z-20 flex h-full flex-col items-center justify-center p-6 text-center">
              <h2 class="font-linux text-text-header mb-2 text-xl font-bold drop-shadow-sm">{game.name}</h2>
              <p class="text-text-secondary font-linux text-base leading-relaxed drop-shadow-sm">{game.desc}</p>
            </div>
            <div class="pointer-events-none absolute inset-0 z-30 rounded-2xl transition duration-300 hover:ring-2 hover:ring-violet-500/60" />
          </a>
        ))
      }
    </div>

    <ImportLucide />
    <script src="../utils/assets"></script>
  </body>
</html>
